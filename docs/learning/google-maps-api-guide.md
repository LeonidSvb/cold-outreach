# Google Maps API: Полное руководство

**Дата:** 2025-11-09
**Цель:** Получать лиды из Google Maps без Apify

---

## Вариант 1: Официальный Google Maps API (рекомендуется)

### Преимущества
```
✅ Легально и стабильно
✅ $200/месяц бесплатно (Free tier)
✅ Высокое качество данных
✅ Не нужны прокси
✅ Быстрый и надёжный
```

### Недостатки
```
❌ Платно после free tier
❌ Ограничения на кол-во полей
❌ Rate limits
```

### Стоимость

**Free Tier:**
```
$200/месяц бесплатных кредитов (обновляются каждый месяц)

Сколько это запросов:
┌────────────────────────┬──────────────┬──────────────┐
│ Endpoint               │ Price/1000   │ Free tier    │
├────────────────────────┼──────────────┼──────────────┤
│ Places Nearby Search   │ $32/1000     │ 6,250 req    │
│ Places Text Search     │ $32/1000     │ 6,250 req    │
│ Place Details          │ $17/1000     │ 11,764 req   │
│ Geocoding             │ $5/1000      │ 40,000 req   │
└────────────────────────┴──────────────┴──────────────┘
```

**ВАЖНО: Правильный расчёт стоимости:**
```
1 лид с телефоном и сайтом:
- Text Search: $0.0016 (1/20 от одного запроса)
- Place Details: $0.023 (один запрос на место)
- ИТОГО: ~$0.0246 за лид

Free tier $200/месяц:
$200 / $0.0246 = ~8,130 полных лидов БЕСПЛАТНО каждый месяц!
```

### Как работает

**1. Создай Google Cloud проект**
```
1. Иди на https://console.cloud.google.com
2. Создай новый проект
3. Включи "Places API"
4. Включи "Geocoding API" (опционально)
5. Создай API ключ в "Credentials"
6. Ограничь ключ только для Places API (безопасность)
```

**2. API Endpoints**

#### A. Text Search (поиск бизнесов)
```
Endpoint: places/textsearch/json
Стоимость: $32/1000 requests
Что возвращает: Список бизнесов по запросу

Пример запроса:
https://maps.googleapis.com/maps/api/place/textsearch/json?query=restaurants+in+Sydney&key=YOUR_API_KEY

Поля (базовые, включены):
- name
- address
- place_id
- rating
- types
```

#### B. Place Details (детали бизнеса)
```
Endpoint: place/details/json
Стоимость: Зависит от полей (от $17/1000)
Что возвращает: Полная информация о бизнесе

Пример запроса:
https://maps.googleapis.com/maps/api/place/details/json?place_id=PLACE_ID&fields=name,formatted_phone_number,website&key=YOUR_API_KEY

Важные поля:
- formatted_phone_number (+$3/1000)
- website (+$3/1000)
- opening_hours (+$0)
- reviews (+$3/1000)

ИТОГО: Basic ($17) + phone ($3) + website ($3) = $23/1000
```

### Pricing Calculator

**Для твоих 10,000 лидов/месяц (ПРАВИЛЬНЫЙ расчёт):**
```
1. Text Search:
   - 10,000 мест / 20 результатов = 500 API calls
   - Стоимость: 500 / 1,000 × $32 = $16

2. Place Details (phone + website):
   - 10,000 мест = 10,000 API calls
   - Стоимость: 10,000 / 1,000 × $23 = $230

ИТОГО: $16 + $230 = $246/месяц
Минус free tier: -$200
РЕАЛЬНО ПЛАТИШЬ: $46/месяц ✅
```

**Можно ещё дешевле:**
```
Используй только 8,000 лидов/месяц (полностью бесплатно):

1. Text Search:
   - 8,000 / 20 = 400 calls
   - 400 / 1,000 × $32 = $12.80

2. Place Details:
   - 8,000 calls
   - 8,000 / 1,000 × $23 = $184

ИТОГО: $196.80
Минус free tier: -$200
ПЛАТИШЬ: $0/месяц ✅

8,000 качественных лидов полностью БЕСПЛАТНО!
```

---

## Вариант 2: Web Scraping (бесплатно, сложнее)

### Преимущества
```
✅ Полностью бесплатно
✅ Нет rate limits (кроме anti-bot)
✅ Можно получить больше данных
```

### Недостатки
```
❌ Нужны прокси (residential)
❌ Google блокирует ботов
❌ Сложнее в поддержке
❌ Может сломаться при изменении UI
❌ Нарушает TOS Google
```

### Стоимость
```
Residential прокси:
- Bright Data: $500 min (overkill)
- Oxylabs: $300 min
- ScraperAPI: $49/месяц (100K requests)

VPS:
- Hetzner: $5-15/месяц

ИТОГО: ~$50-70/месяц
```

---

## Сравнение подходов

| Критерий | Official API | Web Scraping | Apify Actor |
|----------|-------------|--------------|-------------|
| Стоимость (6K leads) | $130/мес | $50-70/мес | $150-200/мес |
| Стоимость (10K leads) | $350/мес | $50-70/мес | $200-300/мес |
| Стабильность | ⭐⭐⭐⭐⭐ | ⭐⭐ | ⭐⭐⭐⭐ |
| Легальность | ✅ | ❌ | ⚠️ |
| Качество данных | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐⭐ |
| Время setup | 30 мин | 10-20 часов | 5 мин |
| Maintenance | Нет | Высокое | Низкое |

---

## Рекомендация

### Для твоего случая (30K сообщений = ~10K лидов):

**Вариант A: Google Maps API (в пределах free tier)**
```
✅ Используй только 6,000 лидов/месяц
✅ Стоимость: $130/месяц
✅ Качество: Максимальное
✅ Стабильность: 100%

Если нужно больше → комбинируй источники:
- 6K из Google Maps API
- 4K из других источников (LinkedIn, Apollo)
```

**Вариант B: Web Scraping (если бюджет критичен)**
```
⚠️ Только если готов:
- Писать сложный код (10-20 часов)
- Покупать прокси ($50/мес)
- Обслуживать и фиксить (5 часов/мес)
- Рисковать с TOS

Экономия: $130 - $70 = $60/месяц
Не стоит усилий при твоём revenue
```

**Вариант C: Комбо (лучшее из обоих)**
```
✅ API для основного потока (6K/мес бесплатно)
✅ Scraping для дополнительных данных
✅ Минимальные затраты + надёжность
```

---

## Следующие шаги

1. Создать Google Cloud проект
2. Получить API ключ
3. Запустить тестовый скрипт (см. ниже)
4. Замерить реальное использование
5. Оптимизировать под free tier
